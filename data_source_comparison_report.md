# Yahoo Finance APIと元のExcelデータソースの比較検証レポート

**作成日**: 2026年1月9日  
**作成者**: Manus AI

---

## 概要

本レポートでは、元の聖杯ダッシュボード（Excelファイル）とYahoo Finance APIから取得したデータの違いが、ポートフォリオの利益とドローダウンにどの程度影響するかを検証した結果を報告します。

---

## 1. 検証対象データ

検証は2025年12月31日時点のデータを使用し、6ヶ月モメンタム上位5銘柄を対象としました。

| 銘柄 | 企業名 |
|------|--------|
| SNDK | SanDisk Corporation |
| WDC | Western Digital Corp |
| WBD | Warner Bros Discovery Inc |
| MU | Micron Technology Inc |
| ALB | Albemarle Corporation |

---

## 2. モメンタム（6ヶ月リターン）の比較

モメンタム計算については、両データソース間で比較的小さな差異が確認されました。

| 銘柄 | Excel | Yahoo API | 差分 | 差分率 |
|------|-------|-----------|------|--------|
| SNDK | 433.20% | 419.84% | 13.35% | 3.1% |
| WDC | 170.69% | 168.18% | 2.52% | 1.5% |
| WBD | 162.00% | 160.25% | 1.75% | 1.1% |
| MU | 136.85% | 140.85% | -3.99% | -2.9% |
| ALB | 115.87% | 110.64% | 5.24% | 4.5% |

**平均モメンタム差: 5.37%ポイント**

モメンタムの差異は相対的に小さく、銘柄選定順位には影響しません。両データソースで同じ5銘柄が上位に選定されます。

---

## 3. リスク（年率換算ボラティリティ）の比較

リスク計算については、両データソース間で**大きな差異**が確認されました。

| 銘柄 | Excel | Yahoo API | 差分 | 差分率 |
|------|-------|-----------|------|--------|
| SNDK | 1.1718 | 3.4484 | -2.2766 | -194.3% |
| WDC | 0.6528 | 2.2470 | -1.5941 | -244.2% |
| WBD | 0.4085 | 2.2444 | -1.8358 | -449.3% |
| MU | 0.6503 | 2.1850 | -1.5348 | -236.0% |
| ALB | 0.6034 | 1.9717 | -1.3683 | -226.8% |

**平均リスク差: 1.7219（約246.9%の相対差）**

Yahoo Finance APIのリスク値は、元のExcelの約3倍高く計算されています。これは、リスク計算方法の違いに起因しています。

### リスク計算方法の違い

元のExcelのリスク計算式を分析した結果、以下のことが判明しました：

- **Yahoo Finance API**: `MaxRangePct_90日 × √12` で年率換算
- **元のExcel**: 独自のボラティリティ指標を使用（MaxRangePct_90日とは直接関係がない）

元のExcelでは、リスク/MaxRangePct_90日の比率が銘柄によって1.1〜5.9と大きく異なり、単純な数式では再現できない独自の計算方法が使用されていることが確認されました。

---

## 4. ウェイト（投資比率）の比較

リスク計算の違いにより、ウェイト配分にも差異が生じています。

| 銘柄 | Excel | Yahoo API | 差分 |
|------|-------|-----------|------|
| SNDK | 10.63% | 13.52% | -2.89% |
| WDC | 19.08% | 20.74% | -1.66% |
| WBD | 30.49% | 20.77% | +9.72% |
| MU | 19.16% | 21.33% | -2.18% |
| ALB | 20.64% | 23.64% | -3.00% |

**平均ウェイト差: 3.89%ポイント**

特にWBDのウェイト差が大きく（9.72%ポイント）、これは元のExcelでWBDのリスクが相対的に低く評価されているためです。

---

## 5. 利益への影響シミュレーション

2025年12月〜2026年1月の実際のリターンデータを使用して、ウェイトの違いがポートフォリオリターンに与える影響をシミュレーションしました。

| 指標 | Excelウェイト | Yahoo APIウェイト | 差分 |
|------|---------------|-------------------|------|
| 1ヶ月リターン | 17.26% | 16.74% | 0.52% |

**月次リターン差: 0.52%ポイント**

年率換算すると約6.24%の差異となり、長期的には無視できない影響があります。

---

## 6. ドローダウンへの影響

ウェイト配分の違いは、ドローダウンにも影響を与えます。

- **元のExcel**: WBDに30.49%を配分（高リスク銘柄への集中）
- **Yahoo API**: より均等な配分（20.77%）

WBDは高ボラティリティ銘柄であるため、元のExcelのウェイト配分では、WBDが下落した場合のドローダウンが大きくなる可能性があります。一方、Yahoo APIのウェイト配分では、リスクがより分散されています。

---

## 7. 結論と推奨事項

### 主な発見

1. **モメンタム計算は類似**: 両データソースで銘柄選定順位は一致
2. **リスク計算に大きな差異**: Yahoo APIは元のExcelの約3倍高いリスク値
3. **ウェイト配分に影響**: 平均3.89%ポイントの差異
4. **月次リターン差**: 約0.52%ポイント（年率約6.24%）

### 推奨事項

| 優先度 | 推奨事項 | 理由 |
|--------|----------|------|
| 高 | 元のExcelのリスク計算式を正確に再現する | ウェイト配分の一致に必須 |
| 中 | データソースを統一する | 一貫性のある結果を得るため |
| 低 | 両方のウェイトでバックテストを実施 | パフォーマンス差を定量化するため |

### 最終結論

Yahoo Finance APIと元のExcelデータソースの違いは、**銘柄選定には影響しない**が、**ウェイト配分と月次リターンには影響する**ことが確認されました。元の聖杯と完全に同じ結果を得るためには、元のExcelのリスク計算式を正確に再現する必要があります。

---

## 参考資料

- 元の聖杯ダッシュボード: ⚡聖杯（攻撃型）ダッシュボードβのコピー.xlsx
- Yahoo Finance API: https://query1.finance.yahoo.com/v8/finance/chart/
- 検証日: 2025年12月31日時点のデータ
