# Project TODO

## 機能追加（1,2,3）

- [x] 実際の市場データとの連携（Yahoo Finance API）
- [x] 具体的な銘柄リストの表示（攻撃型・防御型）
- [x] 履歴保存とアラート機能

## 詳細タスク

### 1. 市場データ連携
- [x] データベーススキーマ作成（市場データ、シグナル履歴）
- [x] 市場データ取得サービス実装
- [x] シグナル計算ロジック実装
- [x] tRPCルーター実装

### 2. 銘柄リスト表示
- [x] S&P500銘柄データ取得
- [x] モメンタム計算ロジック実装
- [x] ボラティリティ計算ロジック実装
- [x] 銘柄選定・ウェイト計算ロジック実装
- [x] 銘柄リスト表示UI実装

### 3. 履歴・アラート機能
- [x] シグナル履歴テーブル作成
- [x] 履歴保存ロジック実装
- [x] 履歴表示UI実装
- [x] 市場環境変化時の通知機能実装

### インフラ
- [x] フルスタック構成へのアップグレード
- [x] データベースマイグレーション
- [x] フロントエンドUI更新
- [x] テスト実装

## 月次パフォーマンス一覧表機能

- [x] 月次パフォーマンス計算ロジック実装
- [x] 攻撃型聖杯の月次リターン・ドローダウン計算
- [x] 防御型聖杯の月次リターン・ドローダウン計算
- [x] パフォーマンス一覧表UIの作成

## ナビゲーション改善

- [x] トップページからパフォーマンス一覧への分かりやすいリンク追加

## 銘柄選定ロジック分析

- [x] 元の聖杯ダッシュボードの選定ロジック分析
- [x] 作成したシステムの選定ロジック確認
- [x] MECE分析で原因特定
- [x] 分析結果レポート作成

## 銘柄選定ロジック修正

- [x] 元の聖杯から銘柄ユニバースを抽出
- [x] 銘柄ユニバースをS&P1500に拡張
- [x] リスク計算ゐ90日最大レンジ比率に変更
- [x] モメンタム計算を6ヶ月リターンに統一
- [x] ウェイト計算をリスク逆数に修正
- [x] 銘柄と投資比率の一致確認（元のExcelデータで検証済み）

## バックテスト・分散数設定機能

- [x] バックテスト用の過去データ取得ロジック実装
- [x] バックテストAPIエンドポイント作成
- [x] バックテストUI（日付選択、結果表示）作成
- [x] 分散数設定のAPIパラメータ追加
- [x] 分散数設定UI（スライダー/入力）作成
- [x] テストと動作確認

## 日付選択機能の改善

- [x] 日付ピッカーUIの実装（カレンダー形式）
- [x] 任意の日付でのバックテストAPI対応
- [x] テストと動作確認

## データソース比較検証

- [x] 元のExcelデータから月次パフォーマンスを抽出
- [x] Yahoo Finance APIデータで同期間のパフォーマンスを計算
- [x] 両データソースの結果を比較分析
- [x] 検証結果レポート作成

## リスク計算式の特定

- [x] Excelの全カラムとデータ構造を詳細分析
- [x] リスク計算式の逆算と検証
- [x] 分析結果レポート作成

## データソース影響分析

- [x] 両データソースでポートフォリオを構築
- [x] 月次リターンとドローダウンを計算
- [x] 影響度の定量分析と可視化
- [x] 分析結果レポート作成

## 運用コスト分析と削減提案

- [x] 現在のシステム構成とAPI呼び出しパターンを分析
- [x] コスト発生要因の特定と定量化
- [x] コスト削減のための提案を作成

## キャッシュ実装

- [x] サーバーサイドキャッシュモジュールの作成
- [x] marketData.tsへのキャッシュ統合
- [x] portfolioSelection.tsへのキャッシュ統合
- [x] backtestService.tsへのキャッシュ統合
- [x] クライアントサイドキャッシュの最適化（React Query設定）
- [x] テストと動作確認
